# =============================================================================
# Pulsar Manager API Configuration
# =============================================================================
# Copy this file to .env and update the values for your environment

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
APP_NAME=pulsar-manager-api
APP_ENV=development
DEBUG=true
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Server Settings
# -----------------------------------------------------------------------------
HOST=0.0.0.0
PORT=8000
WORKERS=1

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql+asyncpg://pulsar:pulsar@localhost:5432/pulsar_manager
DATABASE_POOL_SIZE=5
DATABASE_MAX_OVERFLOW=10
DATABASE_ECHO=false

# -----------------------------------------------------------------------------
# Redis Cache
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
CACHE_TTL_SECONDS=60

# -----------------------------------------------------------------------------
# Pulsar Cluster
# -----------------------------------------------------------------------------
PULSAR_ADMIN_URL=http://localhost:8080
PULSAR_SERVICE_URL=pulsar://localhost:6650
PULSAR_AUTH_TOKEN=
PULSAR_TLS_ENABLED=false
PULSAR_TLS_ALLOW_INSECURE=true

# Connection settings
PULSAR_CONNECT_TIMEOUT=10
PULSAR_READ_TIMEOUT=30
PULSAR_MAX_RETRIES=3

# -----------------------------------------------------------------------------
# Celery Worker
# -----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Stats collection intervals (seconds)
STATS_COLLECTION_INTERVAL=30
BROKER_STATS_INTERVAL=60
AGGREGATION_INTERVAL=60
CLEANUP_INTERVAL=86400

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# Generate with: openssl rand -hex 32
SECRET_KEY=change-me-in-production-use-openssl-rand-hex-32
ENCRYPTION_KEY=change-me-in-production-use-openssl-rand-hex-32

# -----------------------------------------------------------------------------
# Message Browsing Limits
# -----------------------------------------------------------------------------
MAX_MESSAGES_PER_REQUEST=100
MAX_MESSAGE_PAYLOAD_SIZE=1048576
BROWSE_RATE_LIMIT_PER_MINUTE=10

# -----------------------------------------------------------------------------
# CORS Settings
# -----------------------------------------------------------------------------
CORS_ORIGINS=http://localhost:5173,http://localhost:3000
CORS_ALLOW_CREDENTIALS=true

# -----------------------------------------------------------------------------
# OpenTelemetry (optional)
# -----------------------------------------------------------------------------
OTEL_ENABLED=false
OTEL_SERVICE_NAME=pulsar-manager-api
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# -----------------------------------------------------------------------------
# Prometheus Metrics
# -----------------------------------------------------------------------------
METRICS_ENABLED=true
METRICS_PATH=/metrics

# -----------------------------------------------------------------------------
# OIDC Authentication (Optional)
# -----------------------------------------------------------------------------
# Enable OIDC for console authentication
OIDC_ENABLED=false
OIDC_ISSUER_URL=https://auth.example.com
OIDC_CLIENT_ID=pulsar-console

# Client secret is OPTIONAL when using PKCE (recommended)
# OIDC_CLIENT_SECRET=your-client-secret

# PKCE (Proof Key for Code Exchange) - enabled by default
# When enabled, client secret is not required
OIDC_USE_PKCE=true

# -----------------------------------------------------------------------------
# OIDC Group Mapping (Optional)
# -----------------------------------------------------------------------------
# Automatically assign roles based on OIDC group membership

# The OIDC claim containing user groups (default: "groups")
# Common values: "groups", "roles", "memberOf"
OIDC_ROLE_CLAIM=groups

# Comma-separated list of OIDC groups that grant global admin access
# Users in these groups automatically become superusers
# OIDC_ADMIN_GROUPS=admins,superusers,pulsar-admins

# Sync roles on every login (default: true)
# When enabled, roles not matching current OIDC groups are removed
OIDC_SYNC_ROLES_ON_LOGIN=true
